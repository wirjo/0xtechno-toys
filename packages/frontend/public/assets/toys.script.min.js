let hash=tokenData.hash,myColors=[["#1D90F3","#FFFE03","#cd2826"],["#fe3233","#328efd","#fe3233","#328efd","#ae8b61","#d60000"],["#0380d3","#3acc4d","#fa7b14","#e91629"],["#FDCD0B","#F78023","#DB1C23","#E660A2","#0B6EB3"],["#553A71","#6184DB","#50C5B7","#9CEC5B","#F0F465"],["#cf3d5e","#ff7a17","#80aae0","#8d598f","#0168d0"],["#ede0ac","#cab2c8","#78A36A","#938dcd","#83b9d3","#dd726a"],["#f96f69","#ffcdd7","#9ee680","#ff865d","#fdea71","#43c2e2"],["#20be2b","#7c25a8","#ffe127","#f10712","#135ebb"],["#FF9F1C","#00D2FF ","#FFCB61 ","#B0003A "]];var pal,spacing,palNum,startColor,wids=[],xrayMode=!1,toyMode=!1,chromie=!1,whiteOut=!1,blackOut=!1,bgColorMode=!1,bgBlackMode=!1,gridMode=!1,grid=!1,numPieces=0,sc=.5;let R,hideCounter=0;var sortMode,DEFAULT_SIZE=1024,WIDTH=window.innerWidth,HEIGHT=window.innerHeight,DIM=Math.min(WIDTH,HEIGHT),M=DIM/DEFAULT_SIZE;function setup(){pixelDensity(1),colorMode(HSB),createCanvas(DIM,DIM),R=new RandomAB(parseInt(tokenData.hash.slice(0,16),16)),console.log("Hash: "+hash),palNum=R.random_int(0,myColors.length-1),pal=myColors[palNum],console.log("Pal: "+pal+"PalNum: "+palNum),background("#F1EEE8"),noLoop(),spacing=R.random_num(170,385)*M,startColor=R.random_int(0,255),R.random_bool(.3)&&(grid=!0),R.random_bool(.6)&&(toyMode=!0),R.random_bool(.28)&&(xrayMode=!0),R.random_bool(.6)&&(sc=1),R.random_bool(.07)&&!chromie&&(blackOut=!0),!R.random_bool(.07)||blackOut||chromie||(whiteOut=!0),xrayMode&&blendMode(DIFFERENCE)}function draw(){let o=width/2,e=width/2,l=.75*width,t=.75*height;if(grid){console.log("Grid layout");for(let i=o-l/3;i<=o+l/3;i+=l/3)for(let o=e-t/3;o<=e+t/3;o+=t/3){let e=!1;R.random_bool(.25)&&(e=!0,hideCounter++);let l=createVector(i,o);wids.push(new Widget(l,e,0,R.random_choice(pal)))}}else for(let i=0;i<750;i++){let i=R.random_num(o-l/2,o+l/2),r=R.random_num(e-t/2,e+t/2);if(Math.pow(i-o,2)/Math.pow(l/2,2)+Math.pow(r-e,2)/Math.pow(t/2,2)<1&&minDist(i,r,wids,spacing)){loc=createVector(i,r);let o=!1;R.random_bool(.15)&&hideCounter<wids.length-2&&(o=!0,hideCounter++),wids.push(new Widget(loc,o,0,R.random_choice(pal)))}}switch(console.log("Hidden: "+hideCounter),console.log("Wids len: "+wids.length),R.random_int(0,5)){case 0:console.log("Left to Right"),bblSortOnX(wids),sortMode="Left to Right";break;case 1:console.log("Top to Bottom"),bblSortOnY(wids),sortMode="Top to Bottom";break;case 2:console.log("Here and There"),bblSortOnYX(wids),sortMode="Here and There";break;case 3:console.log("Circle"),circleSort(wids),R.random_bool(.12)&&wids.push(wids[0]),sortMode="Circle";break;case 4:console.log("Diagonal"),orginSort(wids),sortMode="Diagonal";break;default:bblSortOnYX(wids),console.log("Here and There"),sortMode="Here and There"}if(R.random_bool(.15)&&wids.length>6&&0==hideCounter&&(chromie=!0),R.random_bool(.23)&&!chromie&&(bgColorMode=!0),R.random_bool(.25)&&!bgColorMode&&toyMode&&(bgBlackMode=!0,background(5)),bgColorMode){let o=R.random_choice(pal);background(hue(o),150,120)}console.log(wids.length),console.log("toy: "+toyMode+", blackOut: "+blackOut+", whiteOut: "+whiteOut);let i="Plain";bgBlackMode&&(i="Dark"),bgColorMode&&(i="Color"),console.log("BG: "+i);let r="Pieces";if(toyMode||(r="Body"),console.log("Toy Mode: "+r),!toyMode)for(let o=0;o<wids.length-1;o++)stroke(5),strokeWeight(180*M),wids[o].hidden||wids[o+1].hidden||(line(wids[o].loc.x,wids[o].loc.y,wids[o+1].loc.x,wids[o+1].loc.y),numPieces++);for(let o=0;o<wids.length;o++)if(stroke(hue(wids[o].color),0,0),fill(wids[o].color),strokeWeight(4),0==wids[o].hidden){if(push(),noStroke(),toyMode){if(o+1==wids.length)break;push(),stroke(5),strokeWeight(256*sc*M),line(wids[o].loc.x,wids[o].loc.y,wids[o+1].loc.x,wids[o+1].loc.y),numPieces++,strokeWeight(180*sc*M),stroke(wids[o+1].color),whiteOut&&stroke(255),blackOut&&stroke(0),chromie&&(stroke((startColor+o*(255/(wids.length+1)))%255,255,255),console.log("CHROMIE")),line(wids[o].loc.x,wids[o].loc.y,wids[o+1].loc.x,wids[o+1].loc.y),pop()}if(R.random_bool(.2)){stroke(wids[o].color),chromie&&(stroke((startColor+o*(255/(wids.length+1)))%255,255,255),console.log("CHROMIE")),strokeWeight(16*M),noFill();let e=R.random_num(64,155)*sc*M;circle(wids[o].loc.x,wids[o].loc.y,e),push(),noStroke(),fill(wids[o].color),chromie&&(fill((startColor+o*(255/(wids.length+1)))%255,255,255),console.log("CHROMIE")),pop(),R.random_bool(.5)&&(chromie&&(fill((startColor+o*(255/(wids.length+1)))%255,255,255),console.log("CHROMIE")),circle(wids[o].loc.x,wids[o].loc.y,e/3))}else{let e=R.random_num(64,155)*sc*M;if(chromie&&(fill((startColor+o*(255/(wids.length+1)))%255,255,255),console.log("CHROMIE")),circle(wids[o].loc.x,wids[o].loc.y,e),push(),noStroke(),fill(wids[o].color),chromie&&(fill((startColor+o*(255/(wids.length+1)))%255,255,255),console.log("CHROMIE")),pop(),R.random_bool(.15)){push();let l=R.random_choice(pal);fill(l),chromie&&(fill((startColor+o*(255/(wids.length+1)))%255,255,255),console.log("CHROMIE")),circle(wids[o].loc.x,wids[o].loc.y,e/2),pop()}}if(pop(),push(),strokeWeight(32*sc*M),stroke(5),point(wids[o].loc.x,wids[o].loc.y),pop(),o+1==wids.length)break}grainTexture(),console.log("Num Toy Pieces: "+numPieces)}function minDist(o,e,l,t){for(let i=0;i<l.length;i++)if(dist2(o,e,l[i].loc.x,l[i].loc.y)<t)return!1;return!0}function dist2(o,e,l,t){var i=o-l,r=e-t;return Math.sqrt(i*i+r*r)}function bblSortOnYX(o){for(var e=0;e<o.length;e++)for(var l=0;l<o.length-e-1;l++)if(o[l].loc.y>o[l+1].loc.x){var t=o[l];o[l]=o[l+1],o[l+1]=t}}function orginSort(o){o.sort(((o,e)=>dist(0,0,o.loc.x,o.loc.y)-dist(0,0,e.loc.x,e.loc.y)))}function bblSortOnX(o){for(var e=0;e<o.length;e++)for(var l=0;l<o.length-e-1;l++)if(o[l].loc.x>o[l+1].loc.x){var t=o[l];o[l]=o[l+1],o[l+1]=t}}function bblSortOnY(o){for(var e=0;e<o.length;e++)for(var l=0;l<o.length-e-1;l++)if(o[l].loc.y>o[l+1].loc.y){var t=o[l];o[l]=o[l+1],o[l+1]=t}}function circleSort(o){var e=width/2,l=height/2;o.sort((function(o,t){return atan2(o.loc.y-l,o.loc.x-e)-atan2(t.loc.y-l,t.loc.x-e)}))}function grainTexture(){loadPixels(),noiseDetail(2,.5),console.log("height: "+height+" DIM: "+DIM);for(let o=0;o<DIM;o++)for(let e=0;e<DIM;e++){let l=4*(e+o*DIM),t=pixels[l],i=pixels[l+1],r=pixels[l+2],s=pixels[l+3],n=32*noise(e+R.random_num(-10,10),o+R.random_num(-10,10));pixels[l]=t+n,pixels[l+1]=i+n,pixels[l+2]=r+n,pixels[l+3]=s}updatePixels()}class Widget{constructor(o,e,l,t){this.loc=o,this.hidden=e,this.numC=l,this.color=t}}const PERLIN_YWRAPB=4,PERLIN_YWRAP=16,PERLIN_ZWRAPB=8,PERLIN_ZWRAP=256,PERLIN_SIZE=4095,PERLIN_OCTAVES=4,PERLIN_AMP_FALLOFF=.5,RANDOM_DEC_PRECISION=1e3,scaled_cosine=o=>.5*(1-Math.cos(o*Math.PI));class RandomAB{constructor(o){this.seed=o,this.perlin=null}random_dec(){return this.seed^=this.seed<<13,this.seed^=this.seed>>17,this.seed^=this.seed<<5,(this.seed<0?1+~this.seed:this.seed)%1e3/1e3}random_num(o,e){return o+(e-o)*this.random_dec()}random_int(o,e){return Math.floor(this.random_num(o,e+1))}random_choice(o){return o[Math.floor(this.random_num(0,.99*o.length))]}random_bool(o){return this.random_dec()<o}noise(o,e){if(null==this.perlin){this.perlin=new Array(4096);for(let o=0;o<4096;o++)this.perlin[o]=this.random_dec()}o<0&&(o=-o),e<0&&(e=-e);let l,t,i,r,s,n=Math.floor(o),d=Math.floor(e),c=o-n,a=e-d,h=0,g=.5;for(let o=0;o<4;o++){let o=n+(d<<4);l=scaled_cosine(c),t=scaled_cosine(a),i=this.perlin[4095&o],i+=l*(this.perlin[o+1&4095]-i),r=this.perlin[o+16&4095],r+=l*(this.perlin[o+16+1&4095]-r),i+=t*(r-i),o+=256,r=this.perlin[4095&o],r+=l*(this.perlin[o+1&4095]-r),s=this.perlin[o+16&4095],s+=l*(this.perlin[o+16+1&4095]-s),r+=t*(s-r),i+=r-i,h+=i*g,g*=.5,n<<=1,c*=2,d<<=1,a*=2,c>=1&&(n++,c--),a>=1&&(d++,a--)}return h}}